---
import Songs from '../components/Songs.astro';
import Artists from '../components/Artists.astro';
import Albums from '../components/Albums.astro';
import Playlists from '../components/Playlists.astro';

export function getStaticPaths() {
  return [
    {params: {year_month: '2023-10'}},
  ];
}

const { year_month } = Astro.params;

const response = await fetch('https://api.spotify-public.homelabwithkevin.com?year_month=' + year_month);
const data = await response.json();

console.log(data)
---

<p>
<div>
<div>Date: {data.year_month}</div>
<table>
    <th>device</th>
    <th>count</th>
{data.top_devices.map((device)=> (
    <tr>
    <td>
        {device.device}
    </td>
    <td>
        {device.count}
    </td>
    </tr>
))}
</table>
</div>
</p>

<p>
<div>
    <Songs stat={data.top_songs}/>
</div>
</p>

<p>
<div>
    <Artists stat={data.top_artists}/>
</div>
</p>

<p>
<div>
    <Albums stat={data.top_albums}/>
</div>
</p>

<p>
<div>
    <Playlists stat={data.top_playlists}/>
</div>
</p>