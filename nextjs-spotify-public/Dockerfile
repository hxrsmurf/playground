FROM node:18-alpine

COPY package.json .
RUN npm install
COPY . .
ARG ACCESS_KEY
ENV ACCESS_KEY=$ACCESS_KEY
ENV ACCESS_KEY_ID=$ACCESS_KEY
ARG SECRET_KEY
ENV AWS_SECRET_ACCESS_KEY=$SECRET_KEY
ENV SECRET_KEY=$SECRET_KEY
ARG REGION
# ENV REGION=$REGION
# ENV REGION=us-east-1
ENV AWS_REGION=$REGION
ARG TABLE
ENV TABLE=$TABLE
ARG TABLE_INDEX
ENV TABLE_INDEX=$TABLE_INDEX
ARG DEVICE_DESKTOP
ENV DEVICE_DESKTOP=$DEVICE_DESKTOP
ARG DEVICE_LAPTOP
ENV DEVICE_LAPTOP=$DEVICE_LAPTOP
ARG DEVICE_TABLET
ENV DEVICE_TABLET=$DEVICE_TABLET
RUN npm run build
CMD npm run start